---
title: k8s存储原理
date: 2022-04-28 18:05:54
permalink: /pages/d165ef/
categories:
  - 后端
  - 华为云原生钻石
tags:
  - 
---


## 上节: k8s为适应不同需求的调度能力,提供了一套调度框架

## 生产环境中,存储也是种类繁杂多样的: `k8s是如何应对的呢?`
  #### 存储产品: 不同存储提供商的产品存在差异性
  #### 存储性能: 不同磁盘(SATA,SAS,PCIE)的性能存在差异性
  #### 存储类型: 本地盘,块存储,文件存储,对象存储
  #### 存储网络: IP,FC等
  #### 存储地域: 不同存储池所服务的地域不同

## 历史
  #### k8s初期为存算分离所做的解耦设计Volume,采用强耦合,灵活性差的in-tree模式,虽然已经让用户专注于业务功能设计. 但这类存储卷的生命周期是跟随pod的,只能用作存储临时数据
  #### 为了支持更多的应用场景,提供了一种脱离pod生命周期的,用户可管理的存储抽象设计低耦合,灵活性更强的PersistentVolume/PersistentVolumeClaim


## 配置数据
  #### ConfigMap size < 1MB
  #### Secret 
  #### Projected

## 临时存储
  #### EmptyDir `内存` `大页内存` `节点上pod所在的文件系统`(默认)
  #### HostPath 不会随pod删除 依赖pod配置 `持久化的简单配置`
  #### In-tree的网格存储 `插件代码与k8s代码耦合`

## 持久存储声明 
  #### PersistentVolumeClaim(网络存储)
         * 具有独立的生命周期,可以通过存储提供商提供的out-tree插件,对接其存储
         * 存储插件类型
           * CSI (标准方案) 

