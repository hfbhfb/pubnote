---
title: linux基准测试_硬盘_CPU_网络
date: 2022-03-15 20:07:58
permalink: /pages/b5ff07/
categories:
  - 运维
  - ES服务ElasticSearch配置
tags:
  - 
---


## fio工具测试硬盘IO  100%  
- 赣州服务器: fio --randrepeat=1 --ioengine=libaio --direct=1 --gtod_reduce=1 --name=test --filename=random_read_write.fio --bs=4k --iodepth=64 --size=1G --readwrite=randrw --rwmixread=75
test: (g=0): rw=randrw, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=libaio, iodepth=64



[参考](https://www.unixmen.com/how-to-measure-disk-performance-with-fio-and-ioping/)


## linux基准测试_硬盘_disi
- 命令 `连续写` : dd if=/dev/zero of=./test.dbf bs=8k count=100k conv=fdatasync
  - 裸机
    - 83886080 bytes (839 MB, 800 MiB) copied, 11.1346 s, 75.3 MB/s
  - 虚拟机
    - 83886080 bytes (839 MB, 800 MiB) copied, 14.2493 s, 58.9 MB/s
  - 虚拟机下raid-z2
    - 83886080 bytes (839 MB, 800 MiB) copied, 53.7335 s, 15.6 MB/s

  - 命令 `连续读` : dd of=/dev/zero if=./test.dbf bs=8k count=100k conv=fdatasync
      - 裸机
        - 83886080 bytes (839 MB, 800 MiB) copied, 9.24201 s, 90.8 MB/s
      - 虚拟机
        - 83886080 bytes (839 MB, 800 MiB) copied, 0.420632 s, 2.0 GB/s
      - 虚拟机下raid-z2
        - 83886080 bytes (839 MB, 800 MiB) copied, 1.36345 s, 614 MB/s
- 结论
  - 虚拟机和裸机写差别不大
  - raid-z2比裸机写差3倍
  - 虚拟机读硬盘没有参考价值




## fio赣州服务器结果
fio-3.16
Starting 1 process
test: Laying out IO file (1 file / 1024MiB)
^Cbs: 1 (f=1): [m(1)][46.1%][r=636KiB/s,w=192KiB/s][r=159,w=48 IOPS][eta 09m:28s]  
fio: terminating on signal 2

test: (groupid=0, jobs=1): err= 0: pid=104695: Tue May 10 23:20:54 2022
  read: IOPS=186, BW=746KiB/s (764kB/s)(353MiB/484787msec)
   bw (  KiB/s): min=    8, max= 1272, per=100.00%, avg=747.21, stdev=253.54, samples=968
   iops        : min=    2, max=  318, avg=186.79, stdev=63.39, samples=968
  write: IOPS=62, BW=249KiB/s (255kB/s)(118MiB/484787msec); 0 zone resets
   bw (  KiB/s): min=    8, max=  520, per=100.00%, avg=255.59, stdev=104.59, samples=944
   iops        : min=    2, max=  130, avg=63.88, stdev=26.15, samples=944
  cpu          : usr=0.26%, sys=0.81%, ctx=44573, majf=0, minf=9
  IO depths    : 1=0.1%, 2=0.1%, 4=0.1%, 8=0.1%, 16=0.1%, 32=0.1%, >=64=99.9%
     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%
     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.1%, >=64=0.0%
     issued rwts: total=90467,30178,0,0 short=0,0,0,0 dropped=0,0,0,0
     latency   : target=0, window=0, percentile=100.00%, depth=64

Run status group 0 (all jobs):
   READ: bw=**746KiB/s** (764kB/s), 746KiB/s-746KiB/s (764kB/s-764kB/s), io=353MiB (371MB), run=484787-484787msec
  WRITE: bw=**249KiB/s** (255kB/s), 249KiB/s-249KiB/s (255kB/s-255kB/s), io=118MiB (124MB), run=484787-484787msec

Disk stats (read/write):
  sdb: ios=91652/31379, merge=78/2070, ticks=24888590/4701332, in_queue=29345500, util=99.77%


