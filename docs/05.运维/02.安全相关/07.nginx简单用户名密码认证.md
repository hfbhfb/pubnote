---
title: nginx简单用户名密码认证
date: 2022-03-17 22:59:44
permalink: /pages/1c5776/
categories:
  - 运维
  - 安全相关
tags:
  - 
---


* 需要认证的网页`ipfs后台`
  * https://gz006.nsmore.ajojo.top:15085/webui
    * 等效但不需要认证的网页 `ipfs后台`
      * https://gz004.nsmore.ajojo.top:15004/webui
  * 使用golang访问 auth_basic 认证
    * 本地项目路径: cd /Users/hfb/projects/go/mod-pro/httpbasicauth
      * make
        * 测试中包含覆盖率,新的知识点
    * git项目路径 : https://github.com/hfbhfb/httpbasicauth

* 如何配置nginx
  * 官方文档
    * https://docs.nginx.com/nginx/admin-guide/security-controls/configuring-http-basic-authentication/
  * 赣州服务器实战
    * 创建用户
      * cd /home/usera/part2dockernginx/apache2
      * sudo htpasswd -c .htpasswd nginxappachuser1
    * docker
      * docker run --name part2dockernginx --restart always -p 15085-15094:15085-15094  -v /home/usera/part2dockernginx/logs:/var/log/nginx -v /home/usera/part2dockernginx/nginx.conf:/etc/nginx/nginx.conf:ro -v /home/usera/serverinfo/fourdomainclient/datadir/certs:/certs:ro -v /home/usera/part2dockernginx/var:/static -v /home/usera/part2dockernginx/apache2:/apache2 -d nginx
    * nginx.conf如下














``` nginx
# 15085-15094

worker_processes  4;
worker_rlimit_nofile 8192;

events {
    worker_connections  2048;
}

stream {
    server {
        listen     15074;
        proxy_pass 192.168.1.211:31004;
    }
}

http {
        include       mime.types;
        access_log /var/log/nginx/access.log;
        error_log /var/log/nginx/error.log;

        client_max_body_size     5000m; #//文件大小限制，默认1m
        client_header_timeout    1m;
        client_body_timeout      1m;
        proxy_connect_timeout     60s;
        proxy_read_timeout      1m;
        proxy_send_timeout      1m;

        server {
                server_name gz006.nsmore.ajojo.top;

                listen 15085 ssl http2;

                ssl_certificate /certs/user3/certs/gz006.nsmore.ajojo.top/certificates/gz006.nsmore.ajojo.top.crt;
                ssl_certificate_key /certs/user3/certs/gz006.nsmore.ajojo.top/certificates/gz006.nsmore.ajojo.top.key;
                ssl_trusted_certificate /certs/user3/certs/gz006.nsmore.ajojo.top/certificates/gz006.nsmore.ajojo.top.crt;


                ssl_session_timeout 1d;
                ssl_session_cache shared:SSL:50m;
                ssl_session_tickets off;

                ssl_protocols TLSv1.2;
                ssl_ciphers EECDH+AESGCM:EECDH+AES;
                ssl_ecdh_curve secp384r1;
                ssl_prefer_server_ciphers on;

                ssl_stapling on;
                ssl_stapling_verify on;

                add_header Strict-Transport-Security "max-age=15768000; includeSubdomains; preload";
                #add_header X-Frame-Options DENY;
                #add_header X-Content-Type-Options nosniff;

                location / {
                        auth_basic           "用户登入";
                        auth_basic_user_file /appach2/.htpasswd; 
                        proxy_pass http://172.17.0.1:19333; 
                }
        }
}
```





